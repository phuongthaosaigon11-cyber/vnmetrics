const fs = require('fs');
const path = require('path');

// DỮ LIỆU THÔ TỪ FILE BẠN GỬI (Đã được nhúng vào đây)
const rawText = `
11 Jan 2024	111.7	227.0	237.9	65.3	17.4	50.1	29.4	10.6	1.0	(95.1)	-	655.3
12 Jan 2024	386.0	195.3	17.4	39.8	28.4	0.0	20.2	0.0	0.0	(484.1)	-	203.0
16 Jan 2024	212.7	102.0	50.2	122.3	31.9	0.0	15.3	7.3	0.0	(594.4)	-	(52.7)
17 Jan 2024	371.4	358.1	68.2	50.3	57.6	1.2	1.2	4.8	1.6	(460.6)	-	453.8
18 Jan 2024	145.5	177.9	20.1	41.8	58.8	0.0	9.3	2.3	0.0	(582.3)	-	(126.6)
19 Jan 2024	201.5	222.3	56.7	62.6	63.4	0.0	10.4	14.2	2.9	(590.4)	-	43.6
22 Jan 2024	260.6	158.7	41.6	65.0	5.6	4.7	9.7	6.8	0.4	(640.5)	-	(87.4)
23 Jan 2024	160.1	157.7	26.3	61.8	0.0	1.1	0.0	2.2	0.0	(515.3)	-	(106.1)
24 Jan 2024	66.2	125.7	19.1	24.9	19.9	1.2	9.1	4.5	0.4	(429.3)	-	(158.3)
25 Jan 2024	170.7	101.0	20.0	16.1	0.0	0.0	6.5	0.0	0.0	(394.1)	-	(79.8)
26 Jan 2024	87.1	100.1	30.9	46.4	0.0	1.2	1.8	2.4	0.0	(255.1)	-	14.8
29 Jan 2024	198.4	208.2	20.0	17.2	3.0	0.0	0.0	0.0	0.0	(191.7)	-	255.1
30 Jan 2024	299.2	119.2	21.9	16.8	6.3	2.5	0.0	0.0	2.1	(220.7)	-	247.3
31 Jan 2024	116.2	232.0	17.8	14.8	1.5	0.0	0.6	2.4	0.0	(187.7)	-	197.6
01 Feb 2024	163.9	35.8	4.2	15.9	0.0	0.0	0.0	0.0	0.7	(182.0)	-	38.5
02 Feb 2024	105.8	78.9	11.5	22.6	0.0	2.5	0.0	2.4	0.9	(144.6)	-	80.0
05 Feb 2024	137.3	38.0	0.0	0.0	0.0	0.0	0.0	0.0	0.7	(107.9)	-	68.1
06 Feb 2024	45.2	37.7	11.3	8.6	0.0	0.0	0.0	2.4	1.1	(72.7)	-	33.6
07 Feb 2024	56.2	130.1	21.4	3.3	8.6	5.1	1.2	0.0	0.9	(80.8)	-	146.0
08 Feb 2024	204.1	128.3	60.5	86.4	13.4	0.0	1.9	10.3	1.7	(101.6)	-	405.0
09 Feb 2024	250.7	188.4	29.1	136.5	(17.4)	1.4	1.4	2.7	0.5	(51.8)	-	541.5
12 Feb 2024	374.7	151.9	33.0	40.0	(20.8)	0.0	1.1	8.5	0.0	(95.0)	-	493.4
13 Feb 2024	493.1	163.6	10.8	40.0	0.0	0.0	0.0	0.0	1.6	(72.8)	-	636.3
14 Feb 2024	224.3	118.9	47.2	101.5	(37.5)	9.0	1.0	2.9	3.6	(131.2)	-	339.7
15 Feb 2024	330.9	97.4	120.2	88.9	1.3	3.0	7.4	2.9	0.0	(174.6)	-	477.4
16 Feb 2024	191.4	116.7	20.9	140.0	1.0	0.0	7.9	0.0	2.8	(150.4)	-	330.3
20 Feb 2024	154.3	71.7	11.1	27.4	0.0	0.0	0.0	5.9	2.2	(137.0)	-	135.6
21 Feb 2024	96.5	52.5	0.0	10.7	1.0	3.0	0.0	0.0	0.0	(199.3)	-	(35.6)
22 Feb 2024	125.1	158.9	7.9	6.7	0.0	0.0	1.2	2.9	4.4	(55.7)	-	251.4
23 Feb 2024	167.5	52.5	12.0	34.5	0.0	1.5	0.0	8.7	0.0	(44.2)	-	232.5
26 Feb 2024	111.8	243.3	37.2	130.6	4.4	7.9	0.0	6.2	0.9	(22.4)	-	519.9
27 Feb 2024	520.2	126.0	18.4	5.4	2.6	16.6	0.0	9.7	3.6	(125.6)	-	576.9
28 Feb 2024	612.1	245.2	9.9	23.8	0.0	0.0	0.0	(3.4)	2.2	(216.4)	-	673.4
29 Feb 2024	603.9	44.8	21.7	9.9	(1.5)	5.4	0.0	7.0	0.0	(598.9)	-	92.3
01 Mar 2024	202.5	49.3	42.3	55.1	0.0	5.4	0.0	(1.8)	0.0	(492.4)	-	(139.6)
04 Mar 2024	420.1	404.6	90.9	38.2	(25.7)	7.8	3.7	(5.7)	(3.2)	(368.0)	-	562.7
05 Mar 2024	788.3	125.6	3.7	63.7	(14.2)	3.6	0.0	3.5	6.6	(332.5)	-	648.3
06 Mar 2024	281.7	205.7	28.6	41.3	3.0	5.8	40.7	0.0	1.4	(276.2)	-	332.0
07 Mar 2024	244.2	473.4	41.4	42.1	0.0	0.0	41.8	1.9	2.5	(374.8)	-	472.5
08 Mar 2024	336.3	130.3	8.0	1.7	(7.6)	8.0	41.4	7.8	0.0	(302.9)	-	223.0
11 Mar 2024	562.9	215.5	49.8	13.0	(9.7)	0.0	43.4	118.8	5.8	(494.1)	-	505.4
12 Mar 2024	849.0	51.6	24.6	93.0	(19.7)	0.0	39.6	82.9	3.0	(79.0)	-	1,045.0
13 Mar 2024	586.5	281.5	5.6	44.6	0.0	19.1	4.1	16.5	2.3	(276.5)	-	683.7
14 Mar 2024	345.4	13.7	0.0	3.5	0.0	4.0	9.4	13.8	0.0	(257.1)	-	132.7
15 Mar 2024	139.8	155.6	20.5	0.0	0.0	2.0	1.2	15.8	3.3	(139.4)	-	198.8
18 Mar 2024	451.5	5.9	17.6	2.7	0.0	0.0	4.8	5.7	0.0	(642.5)	-	(154.3)
19 Mar 2024	75.2	39.6	2.5	0.0	0.0	0.0	0.0	0.0	0.0	(443.5)	-	(326.2)
20 Mar 2024	49.3	12.9	18.6	23.3	(10.2)	19.0	2.9	9.3	0.0	(386.6)	-	(261.5)
21 Mar 2024	233.4	2.9	12.0	2.0	4.2	3.8	4.7	1.8	0.0	(358.8)	-	(94.0)
22 Mar 2024	18.9	18.1	16.3	5.4	4.5	29.6	25.5	0.0	0.0	(169.9)	-	(51.6)
25 Mar 2024	35.5	261.8	14.0	0.0	18.5	20.5	11.2	4.0	0.0	(350.1)	-	15.4
26 Mar 2024	162.2	279.1	16.7	73.6	26.7	26.3	29.9	15.8	0.0	(212.3)	-	418.0
27 Mar 2024	323.8	1.5	0.0	200.7	4.8	4.0	5.1	1.9	1.5	(299.8)	-	243.5
28 Mar 2024	95.1	68.1	67.0	27.6	3.9	0.0	6.0	20.0	0.0	(104.9)	-	182.8
01 Apr 2024	165.9	44.0	1.1	(0.3)	4.2	0.0	0.0	2.0	0.0	(302.6)	-	(85.7)
02 Apr 2024	150.5	44.8	4.3	(87.5)	0.0	0.0	3.7	5.6	0.0	(81.9)	-	39.5
03 Apr 2024	42.0	116.7	23.0	0.0	0.0	3.8	0.0	0.0	3.1	(75.1)	-	113.5
04 Apr 2024	144.0	106.6	11.2	12.0	0.0	0.0	3.4	15.5	0.0	(79.3)	-	213.4
05 Apr 2024	308.8	83.0	7.4	0.0	2.7	0.0	0.0	0.0	0.0	(198.9)	-	203.0
08 Apr 2024	21.3	6.3	40.3	9.3	0.0	0.0	0.0	0.0	2.3	(303.3)	-	(223.8)
09 Apr 2024	128.7	3.0	3.8	0.0	0.0	0.0	0.0	0.0	0.0	(154.9)	-	(19.4)
10 Apr 2024	33.3	76.3	24.3	7.3	0.0	0.0	0.0	0.0	0.0	(17.5)	-	123.7
11 Apr 2024	192.1	4.6	11.1	0.0	0.0	0.0	8.4	0.0	0.0	(124.9)	-	91.3
12 Apr 2024	111.1	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(166.2)	-	(55.1)
15 Apr 2024	73.4	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(110.1)	-	(36.7)
16 Apr 2024	25.8	1.4	0.0	(12.9)	0.0	1.8	1.7	3.6	0.0	(79.4)	-	(58.0)
17 Apr 2024	18.1	0.0	(7.3)	(42.7)	0.0	0.0	0.0	0.0	0.0	(133.1)	-	(165.0)
18 Apr 2024	18.8	37.4	12.8	9.5	0.0	0.0	0.0	7.2	0.0	(90.0)	-	(4.3)
19 Apr 2024	29.3	54.8	4.9	12.5	3.9	1.9	0.0	(1.8)	0.0	(45.8)	-	59.7
22 Apr 2024	19.7	34.8	2.2	22.6	2.7	7.7	0.0	7.5	0.0	(35.0)	-	62.2
23 Apr 2024	37.9	4.4	23.2	33.3	(0.3)	1.9	0.0	(1.9)	0.0	(66.9)	-	31.6
24 Apr 2024	0.0	5.6	0.0	4.2	0.0	0.0	0.0	0.0	0.0	(130.4)	-	(120.6)
25 Apr 2024	0.0	(22.6)	(6.0)	(31.3)	0.0	1.9	(20.2)	0.0	0.0	(139.4)	-	(217.6)
26 Apr 2024	0.0	(2.8)	(3.8)	5.4	0.0	0.0	0.0	0.0	0.0	(82.4)	-	(83.6)
29 Apr 2024	0.0	(6.9)	6.8	(31.3)	0.0	1.8	2.7	0.0	0.0	(24.7)	-	(51.6)
30 Apr 2024	0.0	(35.3)	(34.3)	3.6	(2.4)	0.0	0.0	0.0	0.0	(93.2)	-	(161.6)
01 May 2024	(36.9)	(191.1)	(29.0)	(98.1)	(5.4)	(13.4)	(9.7)	(6.5)	(6.2)	(167.4)	-	(563.7)
02 May 2024	0.0	0.0	0.0	13.3	1.5	3.4	2.3	0.0	0.0	(54.9)	-	(34.4)
03 May 2024	12.7	102.6	33.5	28.1	33.2	60.9	35.6	8.7	0.0	63.0	-	378.3
06 May 2024	21.5	99.2	2.1	75.6	11.1	1.8	0.0	1.8	0.0	3.9	-	217.0
07 May 2024	0.0	4.1	0.0	2.8	6.0	0.0	0.0	0.0	0.0	(28.6)	-	(15.7)
08 May 2024	0.0	0.0	11.5	0.0	0.0	0.0	0.0	0.0	0.0	0.0	-	11.5
09 May 2024	14.2	2.7	6.8	4.4	2.2	1.8	0.0	0.0	0.0	(43.4)	-	(11.3)
10 May 2024	12.4	5.3	0.0	0.0	0.0	0.0	0.0	0.0	0.6	(103.0)	-	(84.7)
13 May 2024	0.0	38.6	20.3	0.0	0.0	0.0	0.0	7.1	0.0	0.0	-	66.0
14 May 2024	0.0	8.1	0.0	133.1	5.5	1.8	1.2	1.7	0.0	(50.9)	-	100.5
15 May 2024	0.0	131.3	86.3	38.6	4.6	1.9	3.7	7.5	2.1	27.0	-	303.0
16 May 2024	93.7	67.1	1.4	62.0	6.2	3.8	18.5	0.0	0.0	4.6	-	257.3
17 May 2024	38.1	99.4	20.8	10.0	5.7	0.0	6.4	9.5	0.0	31.6	-	221.5
20 May 2024	66.4	64.0	24.0	68.3	0.0	0.0	0.0	0.0	5.2	9.3	-	237.2
21 May 2024	290.0	25.8	(4.2)	0.0	0.0	0.0	0.0	(5.9)	0.0	0.0	-	305.7
22 May 2024	92.0	74.6	0.0	3.5	0.0	0.0	0.0	0.0	0.0	(16.1)	-	154.0
23 May 2024	89.0	19.1	0.0	2.0	2.0	0.0	0.0	9.5	0.0	(13.7)	-	107.9
24 May 2024	182.1	43.7	6.4	4.1	0.0	0.0	0.0	15.6	0.0	0.0	-	251.9
28 May 2024	102.5	34.3	3.3	4.1	3.4	0.0	1.2	0.0	1.4	(105.2)	-	45.0
29 May 2024	24.6	17.7	11.0	4.0	1.0	0.0	0.0	0.0	1.1	(31.1)	-	28.3
30 May 2024	1.6	119.1	25.9	(99.9)	2.1	0.0	0.0	0.0	0.0	0.0	-	48.8
31 May 2024	169.1	5.9	0.0	0.0	0.0	0.0	0.0	(1.9)	0.0	(124.3)	-	48.8
03 Jun 2024	0.0	77.0	14.3	10.7	0.0	0.0	0.0	2.0	1.1	0.0	-	105.1
04 Jun 2024	274.4	378.7	61.0	138.7	0.0	0.0	1.6	4.0	0.0	28.2	-	886.6
05 Jun 2024	155.4	220.6	18.5	71.4	3.6	0.0	0.0	4.0	0.0	14.6	-	488.1
06 Jun 2024	349.9	3.1	(3.1)	(96.6)	0.0	0.0	0.0	2.0	0.0	(37.6)	-	217.7
07 Jun 2024	168.3	0.0	(7.9)	6.9	0.0	0.0	0.0	0.0	0.0	(36.3)	-	131.0
10 Jun 2024	6.3	(3.0)	7.6	0.0	(20.5)	0.0	(15.8)	0.0	0.0	(39.5)	-	(64.9)
11 Jun 2024	0.0	(7.4)	(11.7)	(56.5)	0.0	0.0	0.0	(3.8)	0.0	(121.0)	-	(200.4)
12 Jun 2024	15.6	50.6	14.5	8.5	0.0	0.0	0.0	11.6	0.0	0.0	-	100.8
13 Jun 2024	18.2	(106.4)	(9.8)	(52.7)	(2.7)	0.0	0.0	(11.3)	0.0	(61.5)	-	(226.2)
14 Jun 2024	1.5	(80.1)	(7.1)	(49.0)	(2.9)	0.0	0.0	0.0	0.0	(52.3)	-	(189.9)
17 Jun 2024	0.0	(92.0)	2.9	(50.0)	0.0	0.0	0.0	(3.8)	0.0	(3.0)	-	(145.9)
18 Jun 2024	0.0	(83.1)	(7.0)	0.0	0.0	0.0	0.0	0.0	0.0	(62.3)	-	(152.4)
20 Jun 2024	1.5	(51.1)	(31.5)	0.0	(2.0)	0.0	0.0	(3.7)	0.0	(53.1)	-	(139.9)
21 Jun 2024	0.0	(44.8)	0.0	(28.8)	0.0	1.9	0.0	0.0	0.0	(34.2)	-	(105.9)
24 Jun 2024	0.0	(35.2)	(8.2)	(7.2)	(2.4)	(20.9)	0.0	(10.2)	0.0	(90.4)	-	(174.5)
25 Jun 2024	0.0	48.8	15.2	(6.2)	0.0	0.0	0.0	3.5	0.0	(30.3)	-	31.0
26 Jun 2024	0.0	18.6	0.0	(4.9)	0.0	0.0	0.0	3.4	0.0	4.3	-	21.4
27 Jun 2024	0.0	6.7	8.0	1.8	3.1	3.6	0.0	0.0	0.0	(11.4)	-	11.8
28 Jun 2024	82.4	(25.0)	0.0	42.8	0.0	0.0	0.0	0.0	0.0	(27.2)	-	73.0
01 Jul 2024	0.0	65.0	41.4	12.7	3.2	1.8	0.0	5.4	0.0	0.0	-	129.5
02 Jul 2024	14.1	5.4	(6.8)	2.5	0.0	0.0	0.0	3.5	0.0	(32.4)	-	(13.7)
03 Jul 2024	0.0	6.5	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(27.0)	-	(20.5)
05 Jul 2024	0.0	117.4	30.2	11.3	0.0	0.0	0.0	12.8	0.0	(28.6)	-	143.1
08 Jul 2024	187.2	61.5	11.0	8.4	0.0	0.0	0.0	1.6	0.0	25.1	-	294.8
09 Jul 2024	121.0	91.0	(4.7)	43.3	0.0	0.0	0.0	3.3	0.0	(37.5)	-	216.4
10 Jul 2024	22.2	57.8	4.7	5.7	9.5	31.7	20.7	3.3	0.0	(8.2)	-	147.4
11 Jul 2024	72.1	32.7	7.5	4.3	0.0	0.0	0.0	0.0	0.0	(37.7)	-	78.9
12 Jul 2024	120.0	115.1	28.4	13.0	4.0	0.0	0.0	6.6	0.0	23.0	-	310.1
15 Jul 2024	117.2	36.1	15.2	117.2	7.9	3.7	0.0	3.6	0.0	0.0	-	300.9
16 Jul 2024	260.2	61.1	17.3	29.8	20.5	9.4	2.2	22.0	0.0	0.0	-	422.5
17 Jul 2024	110.4	2.8	(6.0)	0.0	0.0	0.0	0.0	0.0	0.0	(53.9)	-	53.3
18 Jul 2024	102.7	2.8	0.0	(47.6)	0.0	0.0	0.0	1.8	0.0	(22.5)	-	37.2
19 Jul 2024	116.2	141.0	44.6	43.6	6.4	3.9	7.6	41.8	1.8	20.3	-	427.2
22 Jul 2024	526.7	23.7	(47.7)	0.0	13.7	7.9	0.0	(38.4)	0.0	0.0	-	485.9
23 Jul 2024	71.9	0.0	(70.3)	(52.3)	0.0	0.0	0.0	0.0	0.0	(27.3)	-	(78.0)
24 Jul 2024	66.0	1.4	0.0	3.3	0.0	0.0	0.0	0.0	0.0	(26.2)	-	44.5
25 Jul 2024	70.7	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(39.6)	-	31.1
26 Jul 2024	23.2	4.5	31.4	0.0	0.0	0.0	0.0	19.2	0.0	(26.5)	-	51.8
29 Jul 2024	205.6	(5.9)	(21.3)	0.0	0.0	0.0	0.0	0.0	0.0	(54.3)	-	124.1
30 Jul 2024	74.9	(2.9)	(3.2)	(7.9)	0.0	0.0	0.0	(5.6)	0.0	(73.6)	-	(18.3)
31 Jul 2024	21.0	(31.6)	(2.5)	(4.6)	0.0	0.0	0.0	0.0	0.0	0.0	18.0	0.3
01 Aug 2024	25.9	(48.4)	(20.7)	(22.4)	0.0	0.0	0.0	(3.6)	0.0	(71.3)	191.1	50.6
02 Aug 2024	42.8	(104.1)	(29.4)	(87.7)	0.0	0.0	0.0	(23.0)	0.0	(45.9)	9.9	(237.4)
05 Aug 2024	0.0	(58.0)	2.9	(69.0)	0.0	0.0	0.0	3.0	0.0	(69.1)	21.8	(168.4)
06 Aug 2024	0.0	(64.5)	0.0	(28.9)	0.0	(23.0)	0.0	0.0	0.0	(32.2)	0.0	(148.6)
07 Aug 2024	52.5	0.0	3.0	0.0	0.0	0.0	0.0	0.0	10.5	(30.6)	9.7	45.1
08 Aug 2024	157.6	65.2	0.0	32.8	0.0	0.0	0.0	3.4	118.5	(182.9)	0.0	194.6
09 Aug 2024	9.6	(19.8)	(18.1)	0.0	0.0	0.0	0.0	0.0	0.0	(77.0)	15.6	(89.7)
12 Aug 2024	13.4	0.0	(17.1)	35.4	0.0	0.0	0.0	0.0	0.0	(11.8)	7.9	27.8
13 Aug 2024	34.6	22.6	16.5	(6.1)	0.0	0.0	0.0	0.0	0.0	(28.6)	0.0	39.0
14 Aug 2024	2.7	(18.0)	(5.8)	(6.8)	0.0	3.4	0.0	0.0	0.0	(56.9)	0.0	(81.4)
15 Aug 2024	0.0	16.2	6.2	0.0	0.0	0.0	0.0	0.0	0.0	(25.0)	13.7	11.1
16 Aug 2024	20.4	61.3	12.0	13.4	0.0	1.7	0.0	0.0	0.0	(72.9)	0.0	35.9
19 Aug 2024	92.7	3.9	(25.7)	0.0	(8.8)	0.0	0.0	0.0	0.0	0.0	0.0	62.1
20 Aug 2024	55.4	0.0	(6.5)	51.9	0.0	0.0	0.0	0.0	0.0	(12.8)	0.0	88.0
21 Aug 2024	8.4	10.7	10.0	0.0	2.5	3.5	0.0	0.0	0.0	(9.8)	14.2	39.5
22 Aug 2024	75.5	9.2	(11.5)	7.8	0.0	0.0	0.0	3.4	4.8	(28.4)	4.0	64.8
23 Aug 2024	86.8	64.0	42.3	23.8	3.2	0.0	2.3	14.4	0.0	(35.6)	50.8	252.0
26 Aug 2024	224.1	(8.3)	(16.6)	0.0	0.0	5.5	0.0	(7.2)	5.1	0.0	0.0	202.6
27 Aug 2024	0.0	0.0	(6.8)	(102.0)	0.0	0.0	0.0	0.0	0.0	(18.3)	0.0	(127.1)
28 Aug 2024	0.0	(10.4)	(8.7)	(59.3)	0.0	0.0	0.0	(10.1)	0.0	(8.0)	(8.8)	(105.3)
29 Aug 2024	(13.5)	(31.1)	(8.1)	5.3	0.0	0.0	(1.7)	0.0	0.0	(22.7)	0.0	(71.8)
30 Aug 2024	0.0	(12.9)	(16.4)	(65.0)	(11.1)	0.0	0.0	0.0	0.0	(70.2)	0.0	(175.6)
03 Sep 2024	0.0	(162.3)	(25.0)	(33.6)	(2.3)	(8.4)	(2.5)	(3.3)	0.0	(50.4)	0.0	(287.8)
04 Sep 2024	0.0	(7.6)	9.5	0.0	0.0	0.0	0.0	(4.9)	0.0	(34.2)	0.0	(37.2)
05 Sep 2024	0.0	(149.5)	(30.0)	0.0	0.0	0.0	0.0	0.0	0.0	(23.2)	(8.4)	(211.1)
06 Sep 2024	0.0	(85.5)	(14.3)	(7.2)	0.0	0.0	(4.6)	0.0	0.0	(52.9)	(5.5)	(170.0)
09 Sep 2024	(9.1)	28.6	22.0	6.8	3.1	0.0	0.0	0.0	0.0	(22.8)	0.0	28.6
10 Sep 2024	0.0	63.2	0.0	12.7	0.0	0.0	0.0	0.0	0.0	0.0	41.1	117.0
11 Sep 2024	0.0	12.6	0.0	(54.0)	2.6	0.0	0.0	0.0	0.0	(4.6)	(0.5)	(43.9)
12 Sep 2024	0.0	11.5	2.2	18.3	0.0	3.4	0.0	4.9	0.0	(6.5)	5.2	39.0
13 Sep 2024	0.0	102.1	43.1	99.3	0.0	5.2	1.7	5.1	0.0	6.7	0.0	263.2
16 Sep 2024	15.8	5.1	0.0	0.0	0.0	5.0	0.0	4.9	0.0	(20.8)	2.8	12.8
17 Sep 2024	0.0	56.6	45.4	42.2	10.2	8.7	0.0	20.5	3.2	0.0	0.0	186.8
18 Sep 2024	0.0	0.0	(3.9)	(43.4)	0.0	0.0	0.0	0.0	0.0	(8.1)	2.7	(52.7)
19 Sep 2024	0.0	49.9	10.4	81.1	0.0	7.4	0.0	0.0	0.0	0.0	9.5	158.3
20 Sep 2024	0.0	26.1	15.1	22.0	3.1	0.0	5.2	7.1	0.0	0.0	13.4	92.0
23 Sep 2024	11.5	24.9	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(40.3)	8.4	4.5
24 Sep 2024	98.9	16.8	17.4	0.0	0.0	0.0	0.0	0.0	0.0	0.0	2.9	136.0
25 Sep 2024	184.4	(33.2)	2.1	(47.4)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	105.9
26 Sep 2024	93.4	74.0	50.4	113.8	6.5	5.7	4.6	22.1	0.0	(7.7)	2.9	365.7
27 Sep 2024	110.8	123.6	12.9	203.1	3.3	0.0	3.3	11.2	0.0	26.2	0.0	494.4
30 Sep 2024	72.2	8.3	(9.7)	(9.5)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	61.3
01 Oct 2024	40.8	(144.7)	(32.7)	(84.3)	0.0	0.0	0.0	(15.8)	0.0	(5.9)	0.0	(242.6)
02 Oct 2024	(13.7)	21.1	(11.5)	(60.3)	0.0	0.0	0.0	0.0	0.0	(27.3)	0.0	(91.7)
03 Oct 2024	36.0	(37.2)	2.6	(58.0)	2.4	0.0	0.0	0.0	0.0	0.0	0.0	(54.2)
04 Oct 2024	0.0	13.6	15.3	5.3	0.0	0.0	0.0	5.3	0.0	(13.9)	0.0	25.6
07 Oct 2024	97.9	103.7	13.1	12.6	2.5	0.0	0.0	5.4	0.0	0.0	0.0	235.2
08 Oct 2024	39.6	(48.8)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(9.4)	0.0	(18.6)
09 Oct 2024	13.9	0.0	(10.0)	(44.5)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(40.6)
10 Oct 2024	(10.8)	(33.8)	(6.2)	(30.3)	0.0	0.0	0.0	0.0	0.0	(18.5)	(21.2)	(120.8)
11 Oct 2024	0.0	117.1	38.8	97.6	7.9	0.0	0.0	14.3	0.0	(22.1)	0.0	253.6
14 Oct 2024	79.5	239.3	100.2	69.8	4.9	5.7	2.8	11.2	0.0	37.8	4.7	555.9
15 Oct 2024	288.8	35.0	0.7	14.7	0.0	0.0	0.0	7.6	2.8	8.0	13.4	371.0
16 Oct 2024	393.4	14.8	12.9	11.5	6.4	11.8	1.9	5.8	0.0	0.0	0.0	458.5
17 Oct 2024	309.0	11.7	0.0	100.2	0.0	3.9	0.0	0.0	0.0	45.7	0.0	470.5
18 Oct 2024	70.4	18.0	36.0	109.9	16.1	0.0	0.0	23.3	0.0	0.0	0.0	273.7
21 Oct 2024	329.0	5.9	(22.1)	(6.1)	0.0	0.0	0.0	(7.6)	0.0	(4.8)	0.0	294.3
22 Oct 2024	43.0	8.8	0.0	(134.7)	0.0	0.0	0.0	3.8	0.0	0.0	0.0	(79.1)
23 Oct 2024	317.5	0.0	(25.2)	(99.0)	0.0	0.0	0.0	(5.6)	0.0	0.0	4.7	192.4
24 Oct 2024	165.5	0.0	29.6	0.0	0.0	0.0	0.0	0.0	0.0	(7.1)	0.0	188.0
25 Oct 2024	292.0	56.9	2.5	33.4	0.0	0.0	0.0	11.3	0.0	0.0	5.9	402.0
28 Oct 2024	315.2	44.1	38.7	59.8	0.0	0.0	0.0	0.0	0.0	0.0	21.6	479.4
29 Oct 2024	642.9	133.9	52.5	12.4	0.0	0.0	0.0	16.5	0.0	(17.3)	29.2	870.1
30 Oct 2024	872.0	12.6	(23.9)	7.2	7.2	0.0	6.1	4.1	0.0	0.0	8.0	893.3
31 Oct 2024	318.8	(75.2)	(74.0)	(94.2)	0.0	0.0	1.9	(13.9)	0.0	(31.1)	0.0	32.3
01 Nov 2024	0.0	(25.6)	(5.6)	(24.1)	0.0	0.0	(1.7)	(5.9)	0.0	(5.5)	13.5	(54.9)
04 Nov 2024	38.4	(169.6)	(79.8)	(138.3)	0.0	(17.6)	(5.7)	(15.3)	0.0	(63.7)	(89.5)	(541.1)
05 Nov 2024	(44.2)	(68.2)	19.3	(12.5)	0.0	(6.0)	(1.3)	(3.9)	0.0	0.0	0.0	(116.8)
06 Nov 2024	(69.1)	308.8	100.9	127.0	0.0	0.0	(2.6)	17.2	0.0	30.9	108.8	621.9
07 Nov 2024	1,119.9	190.9	13.4	17.6	0.0	0.0	0.0	4.3	0.0	7.3	20.4	1,373.8
08 Nov 2024	206.1	33.5	23.0	0.0	0.0	17.8	0.0	13.0	0.0	0.0	0.0	293.4
11 Nov 2024	756.5	135.1	42.7	108.6	8.7	10.1	0.0	0.0	0.0	24.2	28.2	1,114.1
12 Nov 2024	778.3	37.2	0.0	(5.4)	0.0	0.0	0.0	10.1	0.0	(17.8)	15.1	817.5
13 Nov 2024	230.8	186.1	12.3	14.5	0.0	0.0	0.0	5.1	0.0	0.0	61.3	510.1
14 Nov 2024	126.5	(179.2)	(113.9)	(161.7)	0.0	0.0	0.0	2.5	0.0	(69.6)	(5.3)	(400.7)
15 Nov 2024	0.0	(175.1)	(7.4)	(108.6)	0.0	0.0	(1.7)	(7.7)	0.0	(22.5)	(47.0)	(370.0)
18 Nov 2024	89.3	60.0	24.4	13.2	0.0	0.0	0.0	7.7	0.0	5.8	54.4	254.8
19 Nov 2024	216.1	256.1	52.8	267.3	0.0	0.0	0.0	7.9	0.0	16.2	13.1	829.5
20 Nov 2024	626.5	133.9	9.2	3.8	0.0	0.0	0.0	0.0	0.0	0.0	-	773.4
21 Nov 2024	608.4	301.0	68.0	17.2	0.0	5.7	0.0	5.6	0.0	(7.8)	7.0	1,005.1
22 Nov 2024	513.2	21.7	0.0	0.0	5.0	0.0	6.2	5.6	0.0	(67.1)	5.7	490.3
25 Nov 2024	267.8	(134.7)	(280.7)	(110.9)	(10.9)	0.0	0.0	(8.1)	0.0	(158.2)	0.4	(435.3)
26 Nov 2024	0.0	(95.7)	6.5	0.0	(2.3)	0.0	0.0	0.0	0.0	(36.1)	4.8	(122.8)
27 Nov 2024	0.0	40.2	48.0	0.0	0.0	2.8	0.0	0.0	0.0	0.0	12.0	103.0
29 Nov 2024	137.5	106.5	26.5	7.8	0.0	0.0	0.0	33.1	0.0	0.0	8.6	320.0
02 Dec 2024	338.3	25.1	0.0	17.2	0.0	5.6	0.0	(10.9)	0.0	(28.1)	6.4	353.6
03 Dec 2024	693.3	52.2	7.8	(93.5)	0.0	0.0	0.0	16.2	0.0	0.0	0.0	676.0
04 Dec 2024	571.7	17.3	6.4	0.0	0.0	0.0	0.0	0.0	0.0	(94.3)	55.7	556.8
05 Dec 2024	770.5	47.5	(10.2)	12.3	0.0	0.0	0.0	0.0	0.0	(148.8)	95.4	766.7
06 Dec 2024	257.0	120.2	0.0	24.9	0.0	0.0	0.0	0.0	0.0	(32.3)	6.8	376.6
09 Dec 2024	394.1	175.5	(39.0)	(34.3)	0.0	0.0	0.0	0.0	0.0	(24.4)	7.2	479.1
10 Dec 2024	295.6	210.5	0.0	5.8	(11.6)	0.0	0.0	(5.4)	0.0	(62.8)	6.4	438.5
11 Dec 2024	0.0	121.9	12.2	52.7	0.0	0.0	(2.4)	2.9	0.0	20.1	15.7	223.1
12 Dec 2024	431.6	30.5	61.4	9.0	0.0	0.0	0.0	0.0	2.6	(48.4)	110.8	597.5
13 Dec 2024	393.0	60.0	33.2	28.4	0.0	0.0	0.0	8.6	7.0	(105.8)	4.5	428.9
16 Dec 2024	418.2	116.1	30.7	47.7	0.0	0.0	0.0	0.0	0.0	17.6	6.6	636.9
17 Dec 2024	741.4	(128.2)	(24.4)	(17.0)	0.0	0.0	0.0	3.0	0.0	(84.7)	3.8	493.9
18 Dec 2024	359.6	0.0	(16.6)	(6.6)	(25.2)	0.0	0.0	0.0	0.0	(35.9)	0.0	275.3
19 Dec 2024	0.0	(208.5)	(43.6)	(108.4)	(26.0)	0.0	0.0	(10.9)	2.0	(87.9)	(188.6)	(671.9)
20 Dec 2024	(72.7)	(71.9)	0.0	(87.0)	0.0	5.6	0.0	0.0	0.0	(57.4)	6.4	(277.0)
23 Dec 2024	31.7	(146.0)	(23.7)	(15.7)	(25.6)	0.0	0.0	(2.6)	0.0	(38.4)	(6.2)	(226.5)
24 Dec 2024	(188.7)	(83.2)	8.5	(75.0)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(338.4)
26 Dec 2024	56.5	254.4	(8.3)	186.9	0.0	0.0	0.0	2.7	0.0	(24.2)	7.2	475.2
27 Dec 2024	79.4	(208.2)	(36.0)	(112.6)	(14.2)	0.0	0.0	0.0	0.0	3.7	0.0	(287.9)
30 Dec 2024	(36.5)	(154.6)	(31.4)	(26.4)	0.0	0.0	0.0	0.0	0.0	(134.5)	(31.7)	(415.1)
31 Dec 2024	(23.5)	36.8	8.7	(11.2)	0.0	0.0	0.0	0.0	0.0	(9.6)	4.1	5.3
02 Jan 2026	287.4	88.1	41.5	6.7	4.5	13.0	0.0	8.3	0.0	15.4	6.4	471.3
05 Jan 2026	372.5	191.2	38.5	36.0	15.0	13.6	7.2	5.3	0.0	0.0	17.9	697.2
06 Jan 2026	228.7	(312.2)	0.0	(29.5)	0.0	0.0	0.0	(14.4)	0.0	(83.1)	(32.7)	(243.2)
07 Jan 2026	(130.0)	(247.6)	(39.0)	(42.3)	0.0	0.0	0.0	(11.6)	0.0	(15.6)	0.0	(486.1)
08 Jan 2026	(193.3)	(120.5)	3.0	(9.6)	0.0	0.0	0.0	0.0	1.9	(73.1)	(7.2)	(398.8)
09 Jan 2026	(252.0)	7.9	(5.9)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(250.0)
12 Jan 2026	(70.7)	111.7	0.0	0.0	0.0	0.0	0.0	6.5	0.0	64.3	4.9	116.7
13 Jan 2026	126.3	351.4	159.4	84.9	0.0	0.0	0.0	10.0	3.0	0.0	18.8	753.8
14 Jan 2026	648.4	125.4	10.6	27.0	0.0	5.6	0.0	8.3	0.0	15.3	0.0	840.6
15 Jan 2026	315.8	(188.9)	0.0	0.0	0.0	0.0	3.0	0.0	0.0	(36.4)	6.7	100.2
16 Jan 2026	15.1	(205.2)	(90.4)	(69.4)	0.0	0.0	0.0	0.0	0.0	(44.8)	0.0	(394.7)
20 Jan 2026	(56.9)	(152.1)	(40.4)	(46.4)	0.0	(10.4)	0.0	(12.7)	0.0	(160.8)	0.0	(479.7)
21 Jan 2026	(356.6)	(287.7)	(25.9)	(29.8)	0.0	0.0	(3.8)	6.4	0.0	(11.3)	0.0	(708.7)
22 Jan 2026	(22.4)	(9.8)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(32.2)
23 Jan 2026	(101.6)	(1.9)	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	(103.5)
`;

function parseRawData(text) {
    const lines = text.split('\n').filter(l => l.trim());
    const rows = [];
    const headers = ["Date", "IBIT", "FBTC", "BITB", "ARKB", "BTCO", "EZBC", "BRRR", "HODL", "BTCW", "GBTC", "BTC", "Total"];

    for (const line of lines) {
        // Bỏ qua dòng Header hoặc Total nếu có
        if (line.includes('Date') || line.includes('Total') || line.includes('Average') || line.includes('Maximum') || line.includes('Minimum')) continue;

        // Regex tìm Ngày Tháng Năm (VD: 11 Jan 2024)
        const dateMatch = line.match(/^(\d{2}\s+[A-Za-z]{3}\s+\d{4})/);
        if (!dateMatch) continue;

        const dateStr = dateMatch[1];
        // Xóa ngày để lấy phần số
        let remaining = line.replace(dateStr, '').trim();

        // Tách các cột số bằng khoảng trắng hoặc Tab
        const parts = remaining.split(/[\t\s]+/);

        // Đảm bảo đủ cột (ít nhất 12 số)
        if (parts.length < 12) continue;

        const row = { "Date": dateStr };
        const valueKeys = headers.slice(1); // Lấy tên cột trừ Date

        valueKeys.forEach((key, index) => {
            let valStr = parts[index];
            if (!valStr || valStr === '-') valStr = "0";
            
            valStr = valStr.replace(/,/g, ''); // Xóa dấu phẩy
            
            let val = 0;
            // Xử lý số âm trong ngoặc: (123.4) -> -123.4
            if (valStr.includes('(') || valStr.includes(')')) {
                val = -Math.abs(parseFloat(valStr.replace(/[()]/g, '')));
            } else {
                val = parseFloat(valStr);
            }
            row[key] = isNaN(val) ? 0 : val;
        });

        rows.push(row);
    }
    // Đảo ngược để ngày mới nhất lên đầu
    return rows.reverse();
}

const btcRows = parseRawData(rawText);

const finalData = {
  "last_updated": new Date().toISOString(),
  "BTC": {
    "headers": ["Date", "IBIT", "FBTC", "BITB", "ARKB", "BTCO", "EZBC", "BRRR", "HODL", "BTCW", "GBTC", "BTC", "Total"],
    "rows": btcRows
  },
  "ETH": { "headers": [], "rows": [] }, // Để trống
  "SOL": { "headers": [], "rows": [] }  // Để trống
};

const outputPath = path.join(__dirname, '../public/etf_data.json');
fs.writeFileSync(outputPath, JSON.stringify(finalData, null, 2));
console.log(`✅ Đã tạo file dữ liệu thủ công thành công! (${btcRows.length} dòng)`);
